query vulnerability($id: VulnerabilityID!) {
  vulnerability(id: $id) {
    # NEW FIELDS
    id
    createdAt
    severity
    pipeline {
      createdAt
      url: path
    }
    project {
      fullPath: path
    }
    title
    description
    reportType
    scanner {
      name
      url # not in current schema
      version # not in current schema
    }
    location {
      ... on VulnerabilityLocationContainerScanning {
        image
        operatingSystem
      }
      ... on VulnerabilityLocationCoverageFuzzing {
        blobPath
        endLine
        file
        startLine
        class: vulnerableClass
        method: vulnerableMethod
      }
      # VulnerabilityLocationDast only contains unnused fields
      ... on VulnerabilityLocationDependencyScanning {
        blobPath
      }
      ... on VulnerabilityLocationSast {
        blobPath
        endLine
        file
        startLine
        class: vulnerableClass
        method: vulnerableMethod
      }
      ... on VulnerabilityLocationSecretDetection {
        blobPath
        endLine
        file
        startLine
        class: vulnerableClass
        method: vulnerableMethod
      }
    }
    links {
      name
      url
    }
    identifiers {
      url
      name
    }
    request {
      body
      method
      url
      headers {
        name
        value
      }
    }
    response {
      body
      reasonPhrase
      statusCode
      headers {
        name
        value
      }
    }
    supportingMessages {
      name
      response {
        body
        reasonPhrase
        statusCode
        headers {
          name
          value
        }
      }
    }
    evidenceSource {
      name
    }
    assets {
      name
      url
    }
    solution
    remediations {
      diff
    }
    details {
      ... on VulnerabilityDetailBase {
        description
        fieldName
        name
      }
      ... on VulnerabilityDetailBoolean {
        description
        fieldName
        name
        booleanValue: value
      }
      ... on VulnerabilityDetailCode {
        description
        fieldName
        lang
        name
        value
      }
      ... on VulnerabilityDetailCommit {
        description
        fieldName
        name
        value
      }
      ... on VulnerabilityDetailDiff {
        after
        before
        description
        fieldName
        name
      }
      ... on VulnerabilityDetailFileLocation {
        description
        fieldName
        fileName
        lineEnd
        lineStart
        name
      }
      ... on VulnerabilityDetailInt {
        description
        fieldName
        name
        intValue: value
      }
      ... on VulnerabilityDetailList {
        description
        fieldName
        # items - this is going to tricky, since we need to recurse ðŸ¤”
        name
      }
      ... on VulnerabilityDetailMarkdown {
        description
        fieldName
        name
        value
      }
      ... on VulnerabilityDetailModuleLocation {
        description
        fieldName
        moduleName
        name
        offset
      }
      ... on VulnerabilityDetailTable {
        description
        fieldName
        # headers: same thing, will need to recurse
        name
        # rows: and again
      }
      ... on VulnerabilityDetailText {
        description
        fieldName
        name
        value
      }
      ... on VulnerabilityDetailUrl {
        description
        fieldName
        href
        name
        text
      }
    }
    # NEW FIELDS END

    state
    confirmedAt
    # is this used as mergeRequestFeedback? If not, what is mergeRequestFeedback?
    mergeRequest {
      id
      createdAt
      webUrl
    }
    # missing fields:
    # - remediations
    # - createMrUrl (do we need this?)
    # - projectDefaultBranch (I guess we can fetch this from another query e.g. project => defaultBranchId but I couldn't find it)
    # - pipeline.createdAt (referenced in status_description.vue)
    # - pipeline.url
    # - pipeline.id
    resolvedOnDefaultBranch
    issueLinks {
      # used in hasIssue()
      nodes {
        id
        issue {
          description
        }
      }
    }
    detectedAt
    dismissedAt
    resolvedAt
    # replaces dismissedById, confirmedById, resolvedById
    dismissedBy {
      id
    }
    confirmedBy {
      id
    }
    resolvedBy {
      id
    }
  }
}
