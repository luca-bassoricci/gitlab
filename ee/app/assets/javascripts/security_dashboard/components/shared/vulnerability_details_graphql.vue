<script>
import { GlSprintf } from '@gitlab/ui';
import { __ } from '~/locale';
import { SEVERITY_LEVELS_GRAPHQL } from 'ee/security_dashboard/store/constants';
import SeverityBadge from 'ee/vue_shared/security_reports/components/severity_badge.vue';

export default {
  i18n: {
    severityMessage: __('%{labelStart}Severity:%{labelEnd} %{severity}'),
  },
  components: {
    GlSprintf,
    SeverityBadge,
  },
  props: {
    /**
     * Description of the vulnerability finding.
     *
     * @type string
     * */
    description: {
      type: String,
      required: true,
    },
    /**
     * Severity of the vulnerability finding.
     *
     * Possible values: 'INFO', 'UNKNOWN', 'LOW', 'MEDIUM', 'HIGH', 'CRITICAL'
     *
     * @typedef {('INFO'|'UNKNOWN'|'LOW'|'MEDIUM'|'HIGH'|'CRITICAL')} Severity
     * @type Severity
     */
    severity: {
      type: String,
      required: true,
      validator: (v) => SEVERITY_LEVELS_GRAPHQL.includes(v),
    },
  },
};
</script>

<template>
  <article>
    <p data-testid="description">{{ description }}</p>
    <ul class="gl-list-style-none gl-p-0">
      <li data-testid="severity">
        <gl-sprintf :message="$options.i18n.severityMessage">
          <template #label="{ content }">
            <strong>{{ content }}</strong>
          </template>
          <template #severity>
            <severity-badge class="gl-display-inline-block gl-ml-2" :severity="severity" />
          </template>
        </gl-sprintf>
      </li>
    </ul>
  </article>
</template>
